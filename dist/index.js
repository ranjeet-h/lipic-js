var A={consonants:["\u0915","\u0916","\u0917","\u0918","\u0919","\u091A","\u091B","\u091C","\u091D","\u091E","\u091F","\u0920","\u0921","\u0922","\u0923","\u0924","\u0925","\u0926","\u0927","\u0928","\u092A","\u092B","\u092C","\u092D","\u092E","\u092F","\u0930","\u0932","\u0935","\u0936","\u0937","\u0938","\u0939","\u0933"],vowelsIndependent:["\u0905","\u0906","\u0907","\u0908","\u0909","\u090A","\u090B","\u0960","\u090C","\u0961","\u090F","\u0910","\u0913","\u0914","\u0972","\u0911"],vowelMatras:["\u093E","\u093F","\u0940","\u0941","\u0942","\u0943","\u0944","\u0962","\u0963","\u0947","\u0948","\u094B","\u094C","\u0945","\u0949"],halant:"\u094D",digits:["\u0966","\u0967","\u0968","\u0969","\u096A","\u096B","\u096C","\u096D","\u096E","\u096F"],marks:{anusvara:"\u0902",chandrabindu:"\u0901",visarga:"\u0903"}};var C={a:{type:"vowel",glyph:"\u0905",matra:""},aa:{type:"vowel",glyph:"\u0906",matra:"\u093E"},i:{type:"vowel",glyph:"\u0907",matra:"\u093F"},ii:{type:"vowel",glyph:"\u0908",matra:"\u0940"},u:{type:"vowel",glyph:"\u0909",matra:"\u0941"},uu:{type:"vowel",glyph:"\u090A",matra:"\u0942"},ri:{type:"vowel",glyph:"\u090B",matra:"\u0943"},e:{type:"vowel",glyph:"\u090F",matra:"\u0947"},ai:{type:"vowel",glyph:"\u0910",matra:"\u0948"},o:{type:"vowel",glyph:"\u0913",matra:"\u094B"},au:{type:"vowel",glyph:"\u0914",matra:"\u094C"},ae:{type:"vowel",glyph:"\u0972",matra:"\u0945"},aw:{type:"vowel",glyph:"\u0911",matra:"\u0949"},k:{type:"consonant",glyph:"\u0915"},kh:{type:"consonant",glyph:"\u0916"},g:{type:"consonant",glyph:"\u0917"},gh:{type:"consonant",glyph:"\u0918"},ng:{type:"consonant",glyph:"\u0919"},ch:{type:"consonant",glyph:"\u091A"},chh:{type:"consonant",glyph:"\u091B"},j:{type:"consonant",glyph:"\u091C"},jh:{type:"consonant",glyph:"\u091D"},ny:{type:"consonant",glyph:"\u091E"},T:{type:"consonant",glyph:"\u091F"},Th:{type:"consonant",glyph:"\u0920"},D:{type:"consonant",glyph:"\u0921"},Dh:{type:"consonant",glyph:"\u0922"},N:{type:"consonant",glyph:"\u0923"},t:{type:"consonant",glyph:"\u0924"},th:{type:"consonant",glyph:"\u0925"},d:{type:"consonant",glyph:"\u0926"},dh:{type:"consonant",glyph:"\u0927"},n:{type:"consonant",glyph:"\u0928"},p:{type:"consonant",glyph:"\u092A"},ph:{type:"consonant",glyph:"\u092B"},b:{type:"consonant",glyph:"\u092C"},bh:{type:"consonant",glyph:"\u092D"},m:{type:"consonant",glyph:"\u092E"},y:{type:"consonant",glyph:"\u092F"},r:{type:"consonant",glyph:"\u0930"},l:{type:"consonant",glyph:"\u0932"},v:{type:"consonant",glyph:"\u0935"},L:{type:"consonant",glyph:"\u0933"},sh:{type:"consonant",glyph:"\u0936"},Sh:{type:"consonant",glyph:"\u0937"},s:{type:"consonant",glyph:"\u0938"},h:{type:"consonant",glyph:"\u0939"},M:{type:"mark",glyph:"\u0902"},MM:{type:"mark",glyph:"\u0901"},H:{type:"mark",glyph:"\u0903"}};var L={a:{type:"vowel",glyph:"\u0905",matra:""},A:{type:"vowel",glyph:"\u0906",matra:"\u093E"},\u0101:{type:"vowel",glyph:"\u0906",matra:"\u093E"},aa:{type:"vowel",glyph:"\u0906",matra:"\u093E"},ae:{type:"vowel",glyph:"\u0972",matra:"\u0945"},ai:{type:"vowel",glyph:"\u0910",matra:"\u0948"},au:{type:"vowel",glyph:"\u0914",matra:"\u094C"},aw:{type:"vowel",glyph:"\u0911",matra:"\u0949"},b:{type:"consonant",glyph:"\u092C"},bh:{type:"consonant",glyph:"\u092D"},ch:{type:"consonant",glyph:"\u091A"},chh:{type:"consonant",glyph:"\u091B"},d:{type:"consonant",glyph:"\u0926"},D:{type:"consonant",glyph:"\u0921"},dh:{type:"consonant",glyph:"\u0927"},Dh:{type:"consonant",glyph:"\u0922"},dny:{type:"conjunct",glyph:"\u091C\u094D\u091E"},e:{type:"vowel",glyph:"\u090F",matra:"\u0947"},g:{type:"consonant",glyph:"\u0917"},gh:{type:"consonant",glyph:"\u0918"},gy:{type:"conjunct",glyph:"\u091C\u094D\u091E"},h:{type:"consonant",glyph:"\u0939"},H:{type:"mark",glyph:"\u0903"},i:{type:"vowel",glyph:"\u0907",matra:"\u093F"},I:{type:"vowel",glyph:"\u0908",matra:"\u0940"},\u012B:{type:"vowel",glyph:"\u0908",matra:"\u0940"},ii:{type:"vowel",glyph:"\u0908",matra:"\u0940"},j:{type:"consonant",glyph:"\u091C"},jh:{type:"consonant",glyph:"\u091D"},k:{type:"consonant",glyph:"\u0915"},kh:{type:"consonant",glyph:"\u0916"},l:{type:"consonant",glyph:"\u0932"},L:{type:"consonant",glyph:"\u0933"},m:{type:"consonant",glyph:"\u092E"},M:{type:"mark",glyph:"\u0902"},MM:{type:"mark",glyph:"\u0901"},n:{type:"consonant",glyph:"\u0928"},N:{type:"consonant",glyph:"\u0923"},ng:{type:"consonant",glyph:"\u0919"},ny:{type:"consonant",glyph:"\u091E"},o:{type:"vowel",glyph:"\u0913",matra:"\u094B"},p:{type:"consonant",glyph:"\u092A"},ph:{type:"consonant",glyph:"\u092B"},r:{type:"consonant",glyph:"\u0930"},ri:{type:"vowel",glyph:"\u090B",matra:"\u0943"},s:{type:"consonant",glyph:"\u0938"},sh:{type:"consonant",glyph:"\u0936"},Sh:{type:"consonant",glyph:"\u0937"},t:{type:"consonant",glyph:"\u0924"},T:{type:"consonant",glyph:"\u091F"},th:{type:"consonant",glyph:"\u0925"},Th:{type:"consonant",glyph:"\u0920"},u:{type:"vowel",glyph:"\u0909",matra:"\u0941"},U:{type:"vowel",glyph:"\u090A",matra:"\u0942"},\u016B:{type:"vowel",glyph:"\u090A",matra:"\u0942"},uu:{type:"vowel",glyph:"\u090A",matra:"\u0942"},v:{type:"consonant",glyph:"\u0935"},x:{type:"conjunct",glyph:"\u0915\u094D\u0937"},y:{type:"consonant",glyph:"\u092F"}};function S(){return{children:new Map,terminal:null}}function b(e){let o=S();for(let[n,t]of Object.entries(e)){if(n.length===0)continue;let r=o;for(let a of n){let i=r.children.get(a);i||(i=S(),r.children.set(a,i)),r=i}r.terminal={key:n,value:t}}return o}function k(e,o,n=0){let t=e,r=n,a=0,i="",s=null;for(;t&&r<o.length;){let l=o[r],c=t.children.get(l);if(!c)return{isPrefix:!1,matched:a>0,key:i,value:s,length:a};t=c,r+=1,t.terminal&&(a=r-n,i=t.terminal.key,s=t.terminal.value)}return{isPrefix:!!t&&r===o.length,matched:a>0,key:i,value:s,length:a}}function v(){let e=[];return{push(o){e.push(o)},pop(){return e.pop()},clear(){e.length=0},toString(){return e.join("")},size(){return e.length},isEmpty(){return e.length===0}}}function U(e,o){return e==="\u0915"&&(o==="\u0937"||o==="\u0936")?"\u0915\u094D\u0937":e==="\u091C"&&o==="\u091E"?"\u091C\u094D\u091E":e==="\u0924"&&o==="\u092F"?"\u0924\u094D\u092F":e==="\u0917"&&o==="\u092F"?"\u091C\u094D\u091E":null}var N=(e,o)=>{let n=[];for(let t=0;t<e.length;t+=1){let r=e[t],a=e[t+1],i=e[t+2];if(r?.kind==="consonant"&&a?.kind==="halant"&&i?.kind==="consonant"){let s=U(r.glyph,i.glyph);if(s){n.push({kind:"consonant",glyph:s}),t+=2;continue}}n.push(r)}return n};function M(e){return e.kind!=="raw"?!1:/[\s.,!?;:()[\]{}'"-]/u.test(e.text)}var $=new Set(["\u0919","\u091E","\u0923","\u0928","\u092E"]),G=[{chars:new Set(["\u0915","\u0916","\u0917","\u0918"]),nasal:"\u0919"},{chars:new Set(["\u091A","\u091B","\u091C","\u091D"]),nasal:"\u091E"},{chars:new Set(["\u091F","\u0920","\u0921","\u0922"]),nasal:"\u0923"},{chars:new Set(["\u0924","\u0925","\u0926","\u0927"]),nasal:"\u0928"},{chars:new Set(["\u092A","\u092B","\u092C","\u092D"]),nasal:"\u092E"}];function W(e){for(let o of G)if(o.chars.has(e))return o.nasal;return null}var V=(e,o)=>{let n=[];for(let t=0;t<e.length;t+=1){let r=e[t],a=e[t+1],i=e[t+2];if(!(r?.kind==="consonant"&&$.has(r.glyph)&&a?.kind==="halant"&&i?.kind==="consonant")){n.push(r);continue}if(o.options.nasalizationMode==="anusvara"){n.push({kind:"mark",glyph:"\u0902"}),t+=1;continue}let l=W(i.glyph);if(!l){n.push(r);continue}n.push({kind:"consonant",glyph:l})}return n};function T(e,o){return e?.kind==="raw"&&e.text===o}function O(e,o){return e?.kind==="consonant"&&e.glyph===o}function q(e){return e?.kind==="vowelIndependent"&&e.glyph==="\u0905"}function x(e,o,n){return e.push({kind:"consonant",glyph:o}),q(n)?(e.push({kind:"matra",glyph:"\u093E"}),!0):!1}var D=(e,o)=>{let n=[];for(let t=0;t<e.length;t+=1){let r=e[t],a=e[t+1];if(O(r,"\u0915")&&T(a,"*")){let i=e[t+2];if(x(n,"\u0958",i)){t+=2;continue}t+=1;continue}if(O(r,"\u0917")&&T(a,"*")){let i=e[t+2];if(x(n,"\u095A",i)){t+=2;continue}t+=1;continue}if(T(r,"q")){x(n,"\u0958",a)&&(t+=1);continue}if(T(r,"f")){x(n,"\u095E",a)&&(t+=1);continue}n.push(r)}return n};function y(e,o){return e?.kind==="consonant"&&e.glyph===o}function X(e,o){return e?.kind==="matra"&&e.glyph===o}function Y(e,o){return e?.kind==="mark"&&e.glyph===o}function d(e,o){return e?.kind===o}function m(e,o){let n=e[o+1];return!n||M(n)}var z=(e,o)=>{let n=e.map(t=>({...t}));for(let t=0;t<n.length;t+=1)Y(n[t],"\u0902")&&d(n[t+1],"consonant")&&d(n[t+2],"inherentA")&&m(n,t+2)&&(n[t+2]={kind:"matra",glyph:"\u093E"}),y(n[t],"\u0915")&&d(n[t+1],"inherentA")&&y(n[t+2],"\u092F")&&m(n,t+2)&&(n[t+1]={kind:"matra",glyph:"\u093E"}),y(n[t],"\u0958")&&d(n[t+1],"inherentA")&&m(n,t+1)&&(n[t+1]={kind:"matra",glyph:"\u093E"}),y(n[t],"\u0930")&&d(n[t+1],"halant")&&y(n[t+2],"\u0924")&&d(n[t+3],"inherentA")&&y(n[t+4],"\u092F")&&m(n,t+4)&&(n.splice(t+1,1),n[t+2]={kind:"matra",glyph:"\u093E"}),y(n[t],"\u0930")&&d(n[t+1],"halant")&&y(n[t+2],"\u0924")&&X(n[t+3],"\u094B")&&y(n[t+4],"\u0938")&&m(n,t+4)&&n.splice(t+1,1);return n};function H(e,o){let n=o.options.enableNukta?D(e,o):e,t=V(n,o),r=o.options.enableLigatureCollapse?N(t,o):t;return o.options.enableSchwaDeletion?z(r,o):r}var Q={enableNukta:!0,nasalizationMode:"anusvara",enableLigatureCollapse:!0,enableSchwaDeletion:!0};function Z(e){return/[\s.,!?;:()[\]{}"'-]/u.test(e)}function ee(e){return/\s/u.test(e)?"start":"other"}function F(e){return e.kind==="consonant"}function B(e,o){return e.type==="vowel"?o==="afterConsonant"?(e.matra??"")===""?{tokens:[{kind:"inherentA"}],context:"afterVowel"}:{tokens:[{kind:"matra",glyph:e.matra??""}],context:"afterVowel"}:{tokens:[{kind:"vowelIndependent",glyph:e.glyph}],context:"afterVowel"}:e.type==="consonant"||e.type==="conjunct"?{tokens:[{kind:"consonant",glyph:e.glyph}],context:"afterConsonant"}:e.type==="mark"?{tokens:[{kind:"mark",glyph:e.glyph}],context:o}:{tokens:[{kind:"raw",text:e.glyph}],context:o}}function te(e){let o=[];for(let n=0;n<e.length;n+=1){let t=e[n],r=e[n+1];o.push(t),F(t)&&r&&F(r)&&o.push({kind:"halant",glyph:"\u094D"})}return o}function ne(e,o){let n=[],t=0,r="start";for(;t<e.length;){let a=k(o,e,t);if(a.matched&&a.value){if(a.key==="ng"&&t+a.length<e.length&&/[aAiIuUeEoOāīū]/u.test(e[t+a.length])){let c=k(o,"n");if(c.matched&&c.value){let h=B(c.value,r);n.push(...h.tokens),r=h.context,t+=1;continue}}let l=B(a.value,r);n.push(...l.tokens),r=l.context,t+=a.length;continue}let i=e[t];n.push({kind:"raw",text:i}),r=ee(i),t+=1}return te(n)}function oe(e){let o="";for(let n of e)if(n.kind!=="inherentA"){if(n.kind==="raw"){o+=n.text;continue}o+=n.glyph}return o}function re(e,o,n){let t=ne(e,o),a=H(t,{options:n});return oe(a)}function ae(e){let o=e.trie??b(e.expandedMap),n={...Q,...e.rules??{}},t=v(),r="";function a(){let i=re(t.toString(),o,n),s={backspace:r.length,insert:i};return r=i,s}return{processChar(i){return Z(i)?(t.clear(),r="",{backspace:0,insert:i}):(t.push(i),a())},backspace(){return t.isEmpty()?{backspace:0,insert:""}:(t.pop(),a())},commit(){return t.isEmpty()?{backspace:0,insert:""}:(t.clear(),r="",{backspace:0,insert:""})},reset(){t.clear(),r=""}}}function ie(e){let o=e.value.length,n=e.selectionStart??o,t=e.selectionEnd??o;return{start:Math.max(0,Math.min(n,o)),end:Math.max(0,Math.min(t,o))}}function se(e){try{let o=new InputEvent("input",{bubbles:!0,cancelable:!1,inputType:"insertText",data:null});e.dispatchEvent(o)}catch{let o=new Event("input",{bubbles:!0,cancelable:!1});e.dispatchEvent(o)}}function f(e,o,n){let{start:t,end:r}=ie(e),a=Math.max(0,t-Math.max(0,o));if(typeof e.setRangeText=="function")e.setRangeText(n,a,r,"end");else{let s=`${e.value.slice(0,a)}${n}${e.value.slice(r)}`;e.value=s;let l=a+n.length;e.setSelectionRange(l,l)}se(e);let i=a+n.length;return{start:i,end:i}}var w=class{element;constructor(o){this.element=o}deleteAndInsert(o,n,t){if(typeof o=="number"){if(!this.element||typeof n!="string")throw new Error("DOMIntegrator requires a bound element for deleteAndInsert(backspace, insert).");return f(this.element,o,n)}if(typeof n!="number"||typeof t!="string")throw new Error("deleteAndInsert(el, backspace, insert) requires all arguments.");return f(o,n,t)}};function le(e){if(e.childNodes.length===0){let t=e.ownerDocument.createTextNode("");return e.appendChild(t),t}if(e.childNodes.length===1&&e.firstChild?.nodeType===Node.TEXT_NODE)return e.firstChild;let o=e.textContent??"";e.textContent="";let n=e.ownerDocument.createTextNode(o);return e.appendChild(n),n}function R(e,o,n){let t=e.ownerDocument.getSelection();if(!t||t.rangeCount===0)return{collapsed:!1,applied:!1};let r=t.getRangeAt(0);if(!r.collapsed||!e.contains(r.startContainer))return{collapsed:!1,applied:!1};let a=le(e),i=a.data,s=i.length;r.startContainer===a&&(s=Math.max(0,Math.min(r.startOffset,i.length)));let l=Math.max(0,s-Math.max(0,o)),c=`${i.slice(0,l)}${n}${i.slice(s)}`;a.data=c;let h=l+n.length,g=e.ownerDocument.createRange();return g.setStart(a,h),g.collapse(!0),t.removeAllRanges(),t.addRange(g),{collapsed:!0,applied:!0}}function pe(e){return e instanceof HTMLTextAreaElement?!0:e instanceof HTMLInputElement?e.type==="text":!1}function ce(e){return e instanceof HTMLElement&&e.isContentEditable}function ue(e){return e.ctrlKey||e.altKey||e.metaKey}function ye(e){return e===" "||e==="Enter"||e==="Tab"}function he(e){let o=e.element,n=e.engine,t=e.onEditApplied,r=e.onBypass,a=e.enabled??!0,i=!1,s=!1,l=p=>{if(pe(o))return f(o,p.backspace,p.insert),t?.(p),!0;if(ce(o)){let u=R(o,p.backspace,p.insert);return u.collapsed?u.applied?(t?.(p),!0):!1:(r?.("selection"),!1)}return r?.("unsupported-target"),!1},c=()=>{s=!0},h=()=>{s=!1},g=p=>{if(!a){r?.("disabled");return}if(ue(p)){r?.("modifier");return}if(s){r?.("composition");return}if(ye(p.key)){n.commit();return}if(p.key!=="Backspace")return;let u=n.backspace();u.backspace===0&&u.insert===""||l(u)&&p.preventDefault()},I=p=>{if(!a){r?.("disabled");return}if(s){r?.("composition");return}if(p.inputType!=="insertText")return;let u=p.data;if(!u)return;let P=n.processChar(u);l(P)&&p.preventDefault()};return{attach(){i||(o.addEventListener("compositionstart",c),o.addEventListener("compositionend",h),o.addEventListener("keydown",g),o.addEventListener("beforeinput",I),i=!0)},detach(){i&&(o.removeEventListener("compositionstart",c),o.removeEventListener("compositionend",h),o.removeEventListener("keydown",g),o.removeEventListener("beforeinput",I),i=!1)},isAttached(){return i}}}var Ue={devanagari:{base:A},marathi:{phonetic:{base:C,expanded:L}}};export{w as DOMIntegrator,b as buildTrie,he as createInputInterceptor,v as createInputStack,ae as createTransliterationEngine,f as deleteAndInsert,R as deleteAndInsertContentEditable,A as devanagariBase,Ue as maps,C as marathiPhoneticBase,L as marathiPhoneticExpanded,k as walkLongest};
//# sourceMappingURL=index.js.map