var A={consonants:["\u0915","\u0916","\u0917","\u0918","\u0919","\u091A","\u091B","\u091C","\u091D","\u091E","\u091F","\u0920","\u0921","\u0922","\u0923","\u0924","\u0925","\u0926","\u0927","\u0928","\u092A","\u092B","\u092C","\u092D","\u092E","\u092F","\u0930","\u0932","\u0935","\u0936","\u0937","\u0938","\u0939","\u0933"],vowelsIndependent:["\u0905","\u0906","\u0907","\u0908","\u0909","\u090A","\u090B","\u0960","\u090C","\u0961","\u090F","\u0910","\u0913","\u0914","\u0972","\u0911"],vowelMatras:["\u093E","\u093F","\u0940","\u0941","\u0942","\u0943","\u0944","\u0962","\u0963","\u0947","\u0948","\u094B","\u094C","\u0945","\u0949"],halant:"\u094D",digits:["\u0966","\u0967","\u0968","\u0969","\u096A","\u096B","\u096C","\u096D","\u096E","\u096F"],marks:{anusvara:"\u0902",chandrabindu:"\u0901",visarga:"\u0903"}};var C={a:{type:"vowel",glyph:"\u0905",matra:""},aa:{type:"vowel",glyph:"\u0906",matra:"\u093E"},i:{type:"vowel",glyph:"\u0907",matra:"\u093F"},ii:{type:"vowel",glyph:"\u0908",matra:"\u0940"},u:{type:"vowel",glyph:"\u0909",matra:"\u0941"},uu:{type:"vowel",glyph:"\u090A",matra:"\u0942"},ri:{type:"vowel",glyph:"\u090B",matra:"\u0943"},e:{type:"vowel",glyph:"\u090F",matra:"\u0947"},ai:{type:"vowel",glyph:"\u0910",matra:"\u0948"},o:{type:"vowel",glyph:"\u0913",matra:"\u094B"},au:{type:"vowel",glyph:"\u0914",matra:"\u094C"},ae:{type:"vowel",glyph:"\u0972",matra:"\u0945"},aw:{type:"vowel",glyph:"\u0911",matra:"\u0949"},k:{type:"consonant",glyph:"\u0915"},kh:{type:"consonant",glyph:"\u0916"},g:{type:"consonant",glyph:"\u0917"},gh:{type:"consonant",glyph:"\u0918"},ng:{type:"consonant",glyph:"\u0919"},ch:{type:"consonant",glyph:"\u091A"},chh:{type:"consonant",glyph:"\u091B"},j:{type:"consonant",glyph:"\u091C"},jh:{type:"consonant",glyph:"\u091D"},ny:{type:"consonant",glyph:"\u091E"},T:{type:"consonant",glyph:"\u091F"},Th:{type:"consonant",glyph:"\u0920"},D:{type:"consonant",glyph:"\u0921"},Dh:{type:"consonant",glyph:"\u0922"},N:{type:"consonant",glyph:"\u0923"},t:{type:"consonant",glyph:"\u0924"},th:{type:"consonant",glyph:"\u0925"},d:{type:"consonant",glyph:"\u0926"},dh:{type:"consonant",glyph:"\u0927"},n:{type:"consonant",glyph:"\u0928"},p:{type:"consonant",glyph:"\u092A"},ph:{type:"consonant",glyph:"\u092B"},b:{type:"consonant",glyph:"\u092C"},bh:{type:"consonant",glyph:"\u092D"},m:{type:"consonant",glyph:"\u092E"},y:{type:"consonant",glyph:"\u092F"},r:{type:"consonant",glyph:"\u0930"},l:{type:"consonant",glyph:"\u0932"},v:{type:"consonant",glyph:"\u0935"},L:{type:"consonant",glyph:"\u0933"},sh:{type:"consonant",glyph:"\u0936"},Sh:{type:"consonant",glyph:"\u0937"},s:{type:"consonant",glyph:"\u0938"},h:{type:"consonant",glyph:"\u0939"},M:{type:"mark",glyph:"\u0902"},MM:{type:"mark",glyph:"\u0901"},H:{type:"mark",glyph:"\u0903"}};var L={a:{type:"vowel",glyph:"\u0905",matra:""},A:{type:"vowel",glyph:"\u0906",matra:"\u093E"},\u0101:{type:"vowel",glyph:"\u0906",matra:"\u093E"},aa:{type:"vowel",glyph:"\u0906",matra:"\u093E"},ae:{type:"vowel",glyph:"\u0972",matra:"\u0945"},ai:{type:"vowel",glyph:"\u0910",matra:"\u0948"},au:{type:"vowel",glyph:"\u0914",matra:"\u094C"},aw:{type:"vowel",glyph:"\u0911",matra:"\u0949"},b:{type:"consonant",glyph:"\u092C"},bh:{type:"consonant",glyph:"\u092D"},ch:{type:"consonant",glyph:"\u091A"},chh:{type:"consonant",glyph:"\u091B"},d:{type:"consonant",glyph:"\u0926"},D:{type:"consonant",glyph:"\u0921"},dh:{type:"consonant",glyph:"\u0927"},Dh:{type:"consonant",glyph:"\u0922"},dny:{type:"conjunct",glyph:"\u091C\u094D\u091E"},e:{type:"vowel",glyph:"\u090F",matra:"\u0947"},ee:{type:"vowel",glyph:"\u0908",matra:"\u0940"},g:{type:"consonant",glyph:"\u0917"},gh:{type:"consonant",glyph:"\u0918"},gy:{type:"conjunct",glyph:"\u091C\u094D\u091E"},h:{type:"consonant",glyph:"\u0939"},H:{type:"mark",glyph:"\u0903"},i:{type:"vowel",glyph:"\u0907",matra:"\u093F"},I:{type:"vowel",glyph:"\u0908",matra:"\u0940"},\u012B:{type:"vowel",glyph:"\u0908",matra:"\u0940"},ii:{type:"vowel",glyph:"\u0908",matra:"\u0940"},j:{type:"consonant",glyph:"\u091C"},jh:{type:"consonant",glyph:"\u091D"},k:{type:"consonant",glyph:"\u0915"},kh:{type:"consonant",glyph:"\u0916"},l:{type:"consonant",glyph:"\u0932"},L:{type:"consonant",glyph:"\u0933"},m:{type:"consonant",glyph:"\u092E"},M:{type:"mark",glyph:"\u0902"},MM:{type:"mark",glyph:"\u0901"},n:{type:"consonant",glyph:"\u0928"},N:{type:"consonant",glyph:"\u0923"},ng:{type:"consonant",glyph:"\u0919"},ny:{type:"consonant",glyph:"\u091E"},o:{type:"vowel",glyph:"\u0913",matra:"\u094B"},p:{type:"consonant",glyph:"\u092A"},ph:{type:"consonant",glyph:"\u092B"},r:{type:"consonant",glyph:"\u0930"},R:{type:"consonant",glyph:"\u0930"},ri:{type:"vowel",glyph:"\u090B",matra:"\u0943"},s:{type:"consonant",glyph:"\u0938"},sh:{type:"consonant",glyph:"\u0936"},Sh:{type:"consonant",glyph:"\u0937"},t:{type:"consonant",glyph:"\u0924"},T:{type:"consonant",glyph:"\u091F"},th:{type:"consonant",glyph:"\u0925"},Th:{type:"consonant",glyph:"\u0920"},u:{type:"vowel",glyph:"\u0909",matra:"\u0941"},U:{type:"vowel",glyph:"\u090A",matra:"\u0942"},\u016B:{type:"vowel",glyph:"\u090A",matra:"\u0942"},uu:{type:"vowel",glyph:"\u090A",matra:"\u0942"},v:{type:"consonant",glyph:"\u0935"},w:{type:"consonant",glyph:"\u0935"},W:{type:"consonant",glyph:"\u0935"},x:{type:"conjunct",glyph:"\u0915\u094D\u0937"},y:{type:"consonant",glyph:"\u092F"},B:{type:"consonant",glyph:"\u092C"},G:{type:"consonant",glyph:"\u0917"},J:{type:"consonant",glyph:"\u091C"},K:{type:"consonant",glyph:"\u0915"},P:{type:"consonant",glyph:"\u092A"},V:{type:"consonant",glyph:"\u0935"},X:{type:"conjunct",glyph:"\u0915\u094D\u0937"},Y:{type:"consonant",glyph:"\u092F"},E:{type:"vowel",glyph:"\u090F",matra:"\u0947"},O:{type:"vowel",glyph:"\u0913",matra:"\u094B"},Ch:{type:"consonant",glyph:"\u091A"},Ph:{type:"consonant",glyph:"\u092B"},Bh:{type:"consonant",glyph:"\u092D"},Gh:{type:"consonant",glyph:"\u0918"},Kh:{type:"consonant",glyph:"\u0916"},Ny:{type:"consonant",glyph:"\u091E"},Ng:{type:"consonant",glyph:"\u0919"}};function S(){return{children:new Map,terminal:null}}function b(e){let o=S();for(let[n,t]of Object.entries(e)){if(n.length===0)continue;let a=o;for(let i of n){let r=a.children.get(i);r||(r=S(),a.children.set(i,r)),a=r}a.terminal={key:n,value:t}}return o}function k(e,o,n=0){let t=e,a=n,i=0,r="",p=null;for(;t&&a<o.length;){let s=o[a],c=t.children.get(s);if(!c)return{isPrefix:!1,matched:i>0,key:r,value:p,length:i};t=c,a+=1,t.terminal&&(i=a-n,r=t.terminal.key,p=t.terminal.value)}return{isPrefix:!!t&&a===o.length,matched:i>0,key:r,value:p,length:i}}function v(){let e=[];return{push(o){e.push(o)},pop(){return e.pop()},clear(){e.length=0},toString(){return e.join("")},size(){return e.length},isEmpty(){return e.length===0}}}function $(e,o){return e==="\u0915"&&(o==="\u0937"||o==="\u0936")?"\u0915\u094D\u0937":e==="\u091C"&&o==="\u091E"?"\u091C\u094D\u091E":e==="\u0924"&&o==="\u092F"?"\u0924\u094D\u092F":e==="\u0917"&&o==="\u092F"?"\u091C\u094D\u091E":null}var N=(e,o)=>{let n=[];for(let t=0;t<e.length;t+=1){let a=e[t],i=e[t+1],r=e[t+2];if(a?.kind==="consonant"&&i?.kind==="halant"&&r?.kind==="consonant"){let p=$(a.glyph,r.glyph);if(p){n.push({kind:"consonant",glyph:p}),t+=2;continue}}n.push(a)}return n};function M(e){return e.kind!=="raw"?!1:/[\s.,!?;:()[\]{}'"-]/u.test(e.text)}var W=new Set(["\u0919","\u091E","\u0923","\u0928","\u092E"]),q=[{chars:new Set(["\u0915","\u0916","\u0917","\u0918"]),nasal:"\u0919"},{chars:new Set(["\u091A","\u091B","\u091C","\u091D"]),nasal:"\u091E"},{chars:new Set(["\u091F","\u0920","\u0921","\u0922"]),nasal:"\u0923"},{chars:new Set(["\u0924","\u0925","\u0926","\u0927"]),nasal:"\u0928"},{chars:new Set(["\u092A","\u092B","\u092C","\u092D"]),nasal:"\u092E"}];function X(e){for(let o of q)if(o.chars.has(e))return o.nasal;return null}var V=(e,o)=>{let n=[];for(let t=0;t<e.length;t+=1){let a=e[t],i=e[t+1],r=e[t+2];if(!(a?.kind==="consonant"&&W.has(a.glyph)&&i?.kind==="halant"&&r?.kind==="consonant")){n.push(a);continue}if(o.options.nasalizationMode==="anusvara"){n.push({kind:"mark",glyph:"\u0902"}),t+=1;continue}let s=X(r.glyph);if(!s){n.push(a);continue}n.push({kind:"consonant",glyph:s})}return n};function T(e,o){return e?.kind==="raw"&&e.text===o}function O(e,o){return e?.kind==="consonant"&&e.glyph===o}function Y(e){return e?.kind==="vowelIndependent"&&e.glyph==="\u0905"}function x(e,o,n){return e.push({kind:"consonant",glyph:o}),Y(n)?(e.push({kind:"matra",glyph:"\u093E"}),!0):!1}var D=(e,o)=>{let n=[];for(let t=0;t<e.length;t+=1){let a=e[t],i=e[t+1];if(O(a,"\u0915")&&T(i,"*")){let r=e[t+2];if(x(n,"\u0958",r)){t+=2;continue}t+=1;continue}if(O(a,"\u0917")&&T(i,"*")){let r=e[t+2];if(x(n,"\u095A",r)){t+=2;continue}t+=1;continue}if(T(a,"q")){x(n,"\u0958",i)&&(t+=1);continue}if(T(a,"f")){x(n,"\u095E",i)&&(t+=1);continue}n.push(a)}return n};function h(e,o){return e?.kind==="consonant"&&e.glyph===o}function J(e,o){return e?.kind==="matra"&&e.glyph===o}function Q(e,o){return e?.kind==="mark"&&e.glyph===o}function d(e,o){return e?.kind===o}function m(e,o){let n=e[o+1];return!n||M(n)}var z=(e,o)=>{let n=e.map(t=>({...t}));for(let t=0;t<n.length;t+=1)Q(n[t],"\u0902")&&d(n[t+1],"consonant")&&d(n[t+2],"inherentA")&&m(n,t+2)&&(n[t+2]={kind:"matra",glyph:"\u093E"}),h(n[t],"\u0915")&&d(n[t+1],"inherentA")&&h(n[t+2],"\u092F")&&m(n,t+2)&&(n[t+1]={kind:"matra",glyph:"\u093E"}),h(n[t],"\u0958")&&d(n[t+1],"inherentA")&&m(n,t+1)&&(n[t+1]={kind:"matra",glyph:"\u093E"}),h(n[t],"\u0930")&&d(n[t+1],"halant")&&h(n[t+2],"\u0924")&&d(n[t+3],"inherentA")&&h(n[t+4],"\u092F")&&m(n,t+4)&&(n.splice(t+1,1),n[t+2]={kind:"matra",glyph:"\u093E"}),h(n[t],"\u0930")&&d(n[t+1],"halant")&&h(n[t+2],"\u0924")&&J(n[t+3],"\u094B")&&h(n[t+4],"\u0938")&&m(n,t+4)&&n.splice(t+1,1);return n};function H(e,o){let n=o.options.enableNukta?D(e,o):e,t=V(n,o),a=o.options.enableLigatureCollapse?N(t,o):t;return o.options.enableSchwaDeletion?z(a,o):a}var ee={enableNukta:!0,nasalizationMode:"anusvara",enableLigatureCollapse:!0,enableSchwaDeletion:!0};function B(e){return/[\s.,!?;:()[\]{}"'-]/u.test(e)}function te(e){return/\s/u.test(e)?"start":"other"}function F(e){return e.kind==="consonant"}function P(e,o){return e.type==="vowel"?o==="afterConsonant"?(e.matra??"")===""?{tokens:[{kind:"inherentA"}],context:"afterVowel"}:{tokens:[{kind:"matra",glyph:e.matra??""}],context:"afterVowel"}:{tokens:[{kind:"vowelIndependent",glyph:e.glyph}],context:"afterVowel"}:e.type==="consonant"||e.type==="conjunct"?{tokens:[{kind:"consonant",glyph:e.glyph}],context:"afterConsonant"}:e.type==="mark"?{tokens:[{kind:"mark",glyph:e.glyph}],context:o}:{tokens:[{kind:"raw",text:e.glyph}],context:o}}function ne(e){let o=[];for(let n=0;n<e.length;n+=1){let t=e[n],a=e[n+1];o.push(t),F(t)&&a&&F(a)&&o.push({kind:"halant",glyph:"\u094D"})}return o}function oe(e,o){let n=[],t=0,a="start";for(;t<e.length;){let i=k(o,e,t);if(i.matched&&i.value){if(i.key==="ng"&&t+i.length<e.length&&/[aAiIuUeEoOāīū]/u.test(e[t+i.length])){let c=k(o,"n");if(c.matched&&c.value){let u=P(c.value,a);n.push(...u.tokens),a=u.context,t+=1;continue}}let s=P(i.value,a);n.push(...s.tokens),a=s.context,t+=i.length;continue}let r=e[t];n.push({kind:"raw",text:r}),a=te(r),t+=1}return ne(n)}function ae(e){let o="";for(let n of e)if(n.kind!=="inherentA"){if(n.kind==="raw"){o+=n.text;continue}o+=n.glyph}return o}function j(e,o,n){let t=oe(e,o),i=H(t,{options:n});return ae(i)}function re(e){let o=e.trie??b(e.expandedMap),n={...ee,...e.rules??{}},t=v(),a="";function i(){let r=j(t.toString(),o,n),p={backspace:a.length,insert:r};return a=r,p}return{processChar(r){return B(r)?(t.clear(),a="",{backspace:0,insert:r}):(t.push(r),i())},processText(r){t.clear();let p=r.split(/(\s+|[.,!?;:()[\]{}'"-])/),s="";for(let u of p)B(u)||u===""?s+=u:s+=j(u,o,n);let c={backspace:a.length,insert:s};return a=s,c},backspace(){return t.isEmpty()?{backspace:0,insert:""}:(t.pop(),i())},commit(){return t.isEmpty()?{backspace:0,insert:""}:(t.clear(),a="",{backspace:0,insert:""})},reset(){t.clear(),a=""}}}function ie(e){let o=e.value.length,n=e.selectionStart??o,t=e.selectionEnd??o;return{start:Math.max(0,Math.min(n,o)),end:Math.max(0,Math.min(t,o))}}function pe(e){try{let o=new InputEvent("input",{bubbles:!0,cancelable:!1,inputType:"insertText",data:null});e.dispatchEvent(o)}catch{let o=new Event("input",{bubbles:!0,cancelable:!1});e.dispatchEvent(o)}}function f(e,o,n){let{start:t,end:a}=ie(e),i=Math.max(0,t-Math.max(0,o));if(typeof e.setRangeText=="function")e.setRangeText(n,i,a,"end");else{let p=`${e.value.slice(0,i)}${n}${e.value.slice(a)}`;e.value=p;let s=i+n.length;e.setSelectionRange(s,s)}pe(e);let r=i+n.length;return{start:r,end:r}}var w=class{element;constructor(o){this.element=o}deleteAndInsert(o,n,t){if(typeof o=="number"){if(!this.element||typeof n!="string")throw new Error("DOMIntegrator requires a bound element for deleteAndInsert(backspace, insert).");return f(this.element,o,n)}if(typeof n!="number"||typeof t!="string")throw new Error("deleteAndInsert(el, backspace, insert) requires all arguments.");return f(o,n,t)}};function se(e){if(e.childNodes.length===0){let t=e.ownerDocument.createTextNode("");return e.appendChild(t),t}if(e.childNodes.length===1&&e.firstChild?.nodeType===Node.TEXT_NODE)return e.firstChild;let o=e.textContent??"";e.textContent="";let n=e.ownerDocument.createTextNode(o);return e.appendChild(n),n}function R(e,o,n){let t=e.ownerDocument.getSelection();if(!t||t.rangeCount===0)return{collapsed:!1,applied:!1};let a=t.getRangeAt(0);if(!a.collapsed||!e.contains(a.startContainer))return{collapsed:!1,applied:!1};let i=se(e),r=i.data,p=r.length;a.startContainer===i&&(p=Math.max(0,Math.min(a.startOffset,r.length)));let s=Math.max(0,p-Math.max(0,o)),c=`${r.slice(0,s)}${n}${r.slice(p)}`;i.data=c;let u=s+n.length,g=e.ownerDocument.createRange();return g.setStart(i,u),g.collapse(!0),t.removeAllRanges(),t.addRange(g),{collapsed:!0,applied:!0}}function le(e){return e instanceof HTMLTextAreaElement?!0:e instanceof HTMLInputElement?e.type==="text":!1}function ce(e){return e instanceof HTMLElement&&e.isContentEditable}function ue(e){return e.ctrlKey||e.altKey||e.metaKey}function ye(e){return e===" "||e==="Enter"||e==="Tab"}function he(e){let o=e.element,n=e.engine,t=e.onEditApplied,a=e.onBypass,i=e.enabled??!0,r=!1,p=!1,s=l=>{if(le(o))return f(o,l.backspace,l.insert),t?.(l),!0;if(ce(o)){let y=R(o,l.backspace,l.insert);return y.collapsed?y.applied?(t?.(l),!0):!1:(a?.("selection"),!1)}return a?.("unsupported-target"),!1},c=()=>{p=!0},u=()=>{p=!1},g=l=>{if(!i){a?.("disabled");return}if(ue(l)){a?.("modifier");return}if(p){a?.("composition");return}if(ye(l.key)){n.commit();return}if(l.key!=="Backspace")return;let y=n.backspace();y.backspace===0&&y.insert===""||s(y)&&l.preventDefault()},I=l=>{if(!i){a?.("disabled");return}if(p){a?.("composition");return}if(l.inputType!=="insertText")return;let y=l.data;if(!y)return;let K=y.length>1?n.processText(y):n.processChar(y);s(K)&&l.preventDefault()};return{attach(){r||(o.addEventListener("compositionstart",c),o.addEventListener("compositionend",u),o.addEventListener("keydown",g),o.addEventListener("beforeinput",I),r=!0)},detach(){r&&(o.removeEventListener("compositionstart",c),o.removeEventListener("compositionend",u),o.removeEventListener("keydown",g),o.removeEventListener("beforeinput",I),r=!1)},isAttached(){return r}}}var Ge={devanagari:{base:A},marathi:{phonetic:{base:C,expanded:L}}};export{w as DOMIntegrator,b as buildTrie,he as createInputInterceptor,v as createInputStack,re as createTransliterationEngine,f as deleteAndInsert,R as deleteAndInsertContentEditable,A as devanagariBase,Ge as maps,C as marathiPhoneticBase,L as marathiPhoneticExpanded,k as walkLongest};
//# sourceMappingURL=index.js.map