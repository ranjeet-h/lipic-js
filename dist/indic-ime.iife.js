"use strict";var IndicIME=(()=>{var R=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var q=Object.prototype.hasOwnProperty;var X=(e,n)=>{for(var o in n)R(e,o,{get:n[o],enumerable:!0})},Y=(e,n,o,t)=>{if(n&&typeof n=="object"||typeof n=="function")for(let a of W(n))!q.call(e,a)&&a!==o&&R(e,a,{get:()=>n[a],enumerable:!(t=$(n,a))||t.enumerable});return e};var J=e=>Y(R({},"__esModule",{value:!0}),e);var ve={};X(ve,{DOMIntegrator:()=>E,buildTrie:()=>T,createInputInterceptor:()=>G,createInputStack:()=>x,createTransliterationEngine:()=>_,deleteAndInsert:()=>m,deleteAndInsertContentEditable:()=>w,devanagariBase:()=>I,maps:()=>be,marathiPhoneticBase:()=>A,marathiPhoneticExpanded:()=>C,walkLongest:()=>f});var I={consonants:["\u0915","\u0916","\u0917","\u0918","\u0919","\u091A","\u091B","\u091C","\u091D","\u091E","\u091F","\u0920","\u0921","\u0922","\u0923","\u0924","\u0925","\u0926","\u0927","\u0928","\u092A","\u092B","\u092C","\u092D","\u092E","\u092F","\u0930","\u0932","\u0935","\u0936","\u0937","\u0938","\u0939","\u0933"],vowelsIndependent:["\u0905","\u0906","\u0907","\u0908","\u0909","\u090A","\u090B","\u0960","\u090C","\u0961","\u090F","\u0910","\u0913","\u0914","\u0972","\u0911"],vowelMatras:["\u093E","\u093F","\u0940","\u0941","\u0942","\u0943","\u0944","\u0962","\u0963","\u0947","\u0948","\u094B","\u094C","\u0945","\u0949"],halant:"\u094D",digits:["\u0966","\u0967","\u0968","\u0969","\u096A","\u096B","\u096C","\u096D","\u096E","\u096F"],marks:{anusvara:"\u0902",chandrabindu:"\u0901",visarga:"\u0903"}};var A={a:{type:"vowel",glyph:"\u0905",matra:""},aa:{type:"vowel",glyph:"\u0906",matra:"\u093E"},i:{type:"vowel",glyph:"\u0907",matra:"\u093F"},ii:{type:"vowel",glyph:"\u0908",matra:"\u0940"},u:{type:"vowel",glyph:"\u0909",matra:"\u0941"},uu:{type:"vowel",glyph:"\u090A",matra:"\u0942"},ri:{type:"vowel",glyph:"\u090B",matra:"\u0943"},e:{type:"vowel",glyph:"\u090F",matra:"\u0947"},ai:{type:"vowel",glyph:"\u0910",matra:"\u0948"},o:{type:"vowel",glyph:"\u0913",matra:"\u094B"},au:{type:"vowel",glyph:"\u0914",matra:"\u094C"},ae:{type:"vowel",glyph:"\u0972",matra:"\u0945"},aw:{type:"vowel",glyph:"\u0911",matra:"\u0949"},k:{type:"consonant",glyph:"\u0915"},kh:{type:"consonant",glyph:"\u0916"},g:{type:"consonant",glyph:"\u0917"},gh:{type:"consonant",glyph:"\u0918"},ng:{type:"consonant",glyph:"\u0919"},ch:{type:"consonant",glyph:"\u091A"},chh:{type:"consonant",glyph:"\u091B"},j:{type:"consonant",glyph:"\u091C"},jh:{type:"consonant",glyph:"\u091D"},ny:{type:"consonant",glyph:"\u091E"},T:{type:"consonant",glyph:"\u091F"},Th:{type:"consonant",glyph:"\u0920"},D:{type:"consonant",glyph:"\u0921"},Dh:{type:"consonant",glyph:"\u0922"},N:{type:"consonant",glyph:"\u0923"},t:{type:"consonant",glyph:"\u0924"},th:{type:"consonant",glyph:"\u0925"},d:{type:"consonant",glyph:"\u0926"},dh:{type:"consonant",glyph:"\u0927"},n:{type:"consonant",glyph:"\u0928"},p:{type:"consonant",glyph:"\u092A"},ph:{type:"consonant",glyph:"\u092B"},b:{type:"consonant",glyph:"\u092C"},bh:{type:"consonant",glyph:"\u092D"},m:{type:"consonant",glyph:"\u092E"},y:{type:"consonant",glyph:"\u092F"},r:{type:"consonant",glyph:"\u0930"},l:{type:"consonant",glyph:"\u0932"},v:{type:"consonant",glyph:"\u0935"},L:{type:"consonant",glyph:"\u0933"},sh:{type:"consonant",glyph:"\u0936"},Sh:{type:"consonant",glyph:"\u0937"},s:{type:"consonant",glyph:"\u0938"},h:{type:"consonant",glyph:"\u0939"},M:{type:"mark",glyph:"\u0902"},MM:{type:"mark",glyph:"\u0901"},H:{type:"mark",glyph:"\u0903"}};var C={a:{type:"vowel",glyph:"\u0905",matra:""},A:{type:"vowel",glyph:"\u0906",matra:"\u093E"},\u0101:{type:"vowel",glyph:"\u0906",matra:"\u093E"},aa:{type:"vowel",glyph:"\u0906",matra:"\u093E"},ae:{type:"vowel",glyph:"\u0972",matra:"\u0945"},ai:{type:"vowel",glyph:"\u0910",matra:"\u0948"},au:{type:"vowel",glyph:"\u0914",matra:"\u094C"},aw:{type:"vowel",glyph:"\u0911",matra:"\u0949"},b:{type:"consonant",glyph:"\u092C"},bh:{type:"consonant",glyph:"\u092D"},ch:{type:"consonant",glyph:"\u091A"},chh:{type:"consonant",glyph:"\u091B"},d:{type:"consonant",glyph:"\u0926"},D:{type:"consonant",glyph:"\u0921"},dh:{type:"consonant",glyph:"\u0927"},Dh:{type:"consonant",glyph:"\u0922"},dny:{type:"conjunct",glyph:"\u091C\u094D\u091E"},e:{type:"vowel",glyph:"\u090F",matra:"\u0947"},ee:{type:"vowel",glyph:"\u0908",matra:"\u0940"},g:{type:"consonant",glyph:"\u0917"},gh:{type:"consonant",glyph:"\u0918"},gy:{type:"conjunct",glyph:"\u091C\u094D\u091E"},h:{type:"consonant",glyph:"\u0939"},H:{type:"mark",glyph:"\u0903"},i:{type:"vowel",glyph:"\u0907",matra:"\u093F"},I:{type:"vowel",glyph:"\u0908",matra:"\u0940"},\u012B:{type:"vowel",glyph:"\u0908",matra:"\u0940"},ii:{type:"vowel",glyph:"\u0908",matra:"\u0940"},j:{type:"consonant",glyph:"\u091C"},jh:{type:"consonant",glyph:"\u091D"},k:{type:"consonant",glyph:"\u0915"},kh:{type:"consonant",glyph:"\u0916"},l:{type:"consonant",glyph:"\u0932"},L:{type:"consonant",glyph:"\u0933"},m:{type:"consonant",glyph:"\u092E"},M:{type:"mark",glyph:"\u0902"},MM:{type:"mark",glyph:"\u0901"},n:{type:"consonant",glyph:"\u0928"},N:{type:"consonant",glyph:"\u0923"},ng:{type:"consonant",glyph:"\u0919"},ny:{type:"consonant",glyph:"\u091E"},o:{type:"vowel",glyph:"\u0913",matra:"\u094B"},p:{type:"consonant",glyph:"\u092A"},ph:{type:"consonant",glyph:"\u092B"},r:{type:"consonant",glyph:"\u0930"},R:{type:"consonant",glyph:"\u0930"},ri:{type:"vowel",glyph:"\u090B",matra:"\u0943"},s:{type:"consonant",glyph:"\u0938"},sh:{type:"consonant",glyph:"\u0936"},Sh:{type:"consonant",glyph:"\u0937"},t:{type:"consonant",glyph:"\u0924"},T:{type:"consonant",glyph:"\u091F"},th:{type:"consonant",glyph:"\u0925"},Th:{type:"consonant",glyph:"\u0920"},u:{type:"vowel",glyph:"\u0909",matra:"\u0941"},U:{type:"vowel",glyph:"\u090A",matra:"\u0942"},\u016B:{type:"vowel",glyph:"\u090A",matra:"\u0942"},uu:{type:"vowel",glyph:"\u090A",matra:"\u0942"},v:{type:"consonant",glyph:"\u0935"},w:{type:"consonant",glyph:"\u0935"},W:{type:"consonant",glyph:"\u0935"},x:{type:"conjunct",glyph:"\u0915\u094D\u0937"},y:{type:"consonant",glyph:"\u092F"},B:{type:"consonant",glyph:"\u092C"},G:{type:"consonant",glyph:"\u0917"},J:{type:"consonant",glyph:"\u091C"},K:{type:"consonant",glyph:"\u0915"},P:{type:"consonant",glyph:"\u092A"},V:{type:"consonant",glyph:"\u0935"},X:{type:"conjunct",glyph:"\u0915\u094D\u0937"},Y:{type:"consonant",glyph:"\u092F"},E:{type:"vowel",glyph:"\u090F",matra:"\u0947"},O:{type:"vowel",glyph:"\u0913",matra:"\u094B"},Ch:{type:"consonant",glyph:"\u091A"},Ph:{type:"consonant",glyph:"\u092B"},Bh:{type:"consonant",glyph:"\u092D"},Gh:{type:"consonant",glyph:"\u0918"},Kh:{type:"consonant",glyph:"\u0916"},Ny:{type:"consonant",glyph:"\u091E"},Ng:{type:"consonant",glyph:"\u0919"}};function N(){return{children:new Map,terminal:null}}function T(e){let n=N();for(let[o,t]of Object.entries(e)){if(o.length===0)continue;let a=n;for(let i of o){let r=a.children.get(i);r||(r=N(),a.children.set(i,r)),a=r}a.terminal={key:o,value:t}}return n}function f(e,n,o=0){let t=e,a=o,i=0,r="",p=null;for(;t&&a<n.length;){let s=n[a],c=t.children.get(s);if(!c)return{isPrefix:!1,matched:i>0,key:r,value:p,length:i};t=c,a+=1,t.terminal&&(i=a-o,r=t.terminal.key,p=t.terminal.value)}return{isPrefix:!!t&&a===n.length,matched:i>0,key:r,value:p,length:i}}function x(){let e=[];return{push(n){e.push(n)},pop(){return e.pop()},clear(){e.length=0},toString(){return e.join("")},size(){return e.length},isEmpty(){return e.length===0}}}function te(e,n){return e==="\u0915"&&(n==="\u0937"||n==="\u0936")?"\u0915\u094D\u0937":e==="\u091C"&&n==="\u091E"?"\u091C\u094D\u091E":e==="\u0924"&&n==="\u092F"?"\u0924\u094D\u092F":e==="\u0917"&&n==="\u092F"?"\u091C\u094D\u091E":null}var M=(e,n)=>{let o=[];for(let t=0;t<e.length;t+=1){let a=e[t],i=e[t+1],r=e[t+2];if(a?.kind==="consonant"&&i?.kind==="halant"&&r?.kind==="consonant"){let p=te(a.glyph,r.glyph);if(p){o.push({kind:"consonant",glyph:p}),t+=2;continue}}o.push(a)}return o};function V(e){return e.kind!=="raw"?!1:/[\s.,!?;:()[\]{}'"-]/u.test(e.text)}var ne=new Set(["\u0919","\u091E","\u0923","\u0928","\u092E"]),oe=[{chars:new Set(["\u0915","\u0916","\u0917","\u0918"]),nasal:"\u0919"},{chars:new Set(["\u091A","\u091B","\u091C","\u091D"]),nasal:"\u091E"},{chars:new Set(["\u091F","\u0920","\u0921","\u0922"]),nasal:"\u0923"},{chars:new Set(["\u0924","\u0925","\u0926","\u0927"]),nasal:"\u0928"},{chars:new Set(["\u092A","\u092B","\u092C","\u092D"]),nasal:"\u092E"}];function ae(e){for(let n of oe)if(n.chars.has(e))return n.nasal;return null}var O=(e,n)=>{let o=[];for(let t=0;t<e.length;t+=1){let a=e[t],i=e[t+1],r=e[t+2];if(!(a?.kind==="consonant"&&ne.has(a.glyph)&&i?.kind==="halant"&&r?.kind==="consonant")){o.push(a);continue}if(n.options.nasalizationMode==="anusvara"){o.push({kind:"mark",glyph:"\u0902"}),t+=1;continue}let s=ae(r.glyph);if(!s){o.push(a);continue}o.push({kind:"consonant",glyph:s})}return o};function b(e,n){return e?.kind==="raw"&&e.text===n}function D(e,n){return e?.kind==="consonant"&&e.glyph===n}function re(e){return e?.kind==="vowelIndependent"&&e.glyph==="\u0905"}function v(e,n,o){return e.push({kind:"consonant",glyph:n}),re(o)?(e.push({kind:"matra",glyph:"\u093E"}),!0):!1}var z=(e,n)=>{let o=[];for(let t=0;t<e.length;t+=1){let a=e[t],i=e[t+1];if(D(a,"\u0915")&&b(i,"*")){let r=e[t+2];if(v(o,"\u0958",r)){t+=2;continue}t+=1;continue}if(D(a,"\u0917")&&b(i,"*")){let r=e[t+2];if(v(o,"\u095A",r)){t+=2;continue}t+=1;continue}if(b(a,"q")){v(o,"\u0958",i)&&(t+=1);continue}if(b(a,"f")){v(o,"\u095E",i)&&(t+=1);continue}o.push(a)}return o};function h(e,n){return e?.kind==="consonant"&&e.glyph===n}function ie(e,n){return e?.kind==="matra"&&e.glyph===n}function pe(e,n){return e?.kind==="mark"&&e.glyph===n}function d(e,n){return e?.kind===n}function k(e,n){let o=e[n+1];return!o||V(o)}var H=(e,n)=>{let o=e.map(t=>({...t}));for(let t=0;t<o.length;t+=1)pe(o[t],"\u0902")&&d(o[t+1],"consonant")&&d(o[t+2],"inherentA")&&k(o,t+2)&&(o[t+2]={kind:"matra",glyph:"\u093E"}),h(o[t],"\u0915")&&d(o[t+1],"inherentA")&&h(o[t+2],"\u092F")&&k(o,t+2)&&(o[t+1]={kind:"matra",glyph:"\u093E"}),h(o[t],"\u0958")&&d(o[t+1],"inherentA")&&k(o,t+1)&&(o[t+1]={kind:"matra",glyph:"\u093E"}),h(o[t],"\u0930")&&d(o[t+1],"halant")&&h(o[t+2],"\u0924")&&d(o[t+3],"inherentA")&&h(o[t+4],"\u092F")&&k(o,t+4)&&(o.splice(t+1,1),o[t+2]={kind:"matra",glyph:"\u093E"}),h(o[t],"\u0930")&&d(o[t+1],"halant")&&h(o[t+2],"\u0924")&&ie(o[t+3],"\u094B")&&h(o[t+4],"\u0938")&&k(o,t+4)&&o.splice(t+1,1);return o};function B(e,n){let o=n.options.enableNukta?z(e,n):e,t=O(o,n),a=n.options.enableLigatureCollapse?M(t,n):t;return n.options.enableSchwaDeletion?H(a,n):a}var le={enableNukta:!0,nasalizationMode:"anusvara",enableLigatureCollapse:!0,enableSchwaDeletion:!0};function F(e){return/[\s.,!?;:()[\]{}"'-]/u.test(e)}function ce(e){return/\s/u.test(e)?"start":"other"}function P(e){return e.kind==="consonant"}function j(e,n){return e.type==="vowel"?n==="afterConsonant"?(e.matra??"")===""?{tokens:[{kind:"inherentA"}],context:"afterVowel"}:{tokens:[{kind:"matra",glyph:e.matra??""}],context:"afterVowel"}:{tokens:[{kind:"vowelIndependent",glyph:e.glyph}],context:"afterVowel"}:e.type==="consonant"||e.type==="conjunct"?{tokens:[{kind:"consonant",glyph:e.glyph}],context:"afterConsonant"}:e.type==="mark"?{tokens:[{kind:"mark",glyph:e.glyph}],context:n}:{tokens:[{kind:"raw",text:e.glyph}],context:n}}function ue(e){let n=[];for(let o=0;o<e.length;o+=1){let t=e[o],a=e[o+1];n.push(t),P(t)&&a&&P(a)&&n.push({kind:"halant",glyph:"\u094D"})}return n}function ye(e,n){let o=[],t=0,a="start";for(;t<e.length;){let i=f(n,e,t);if(i.matched&&i.value){if(i.key==="ng"&&t+i.length<e.length&&/[aAiIuUeEoOāīū]/u.test(e[t+i.length])){let c=f(n,"n");if(c.matched&&c.value){let u=j(c.value,a);o.push(...u.tokens),a=u.context,t+=1;continue}}let s=j(i.value,a);o.push(...s.tokens),a=s.context,t+=i.length;continue}let r=e[t];o.push({kind:"raw",text:r}),a=ce(r),t+=1}return ue(o)}function he(e){let n="";for(let o of e)if(o.kind!=="inherentA"){if(o.kind==="raw"){n+=o.text;continue}n+=o.glyph}return n}function K(e,n,o){let t=ye(e,n),i=B(t,{options:o});return he(i)}function _(e){let n=e.trie??T(e.expandedMap),o={...le,...e.rules??{}},t=x(),a="";function i(){let r=K(t.toString(),n,o),p={backspace:a.length,insert:r};return a=r,p}return{processChar(r){return F(r)?(t.clear(),a="",{backspace:0,insert:r}):(t.push(r),i())},processText(r){t.clear();let p=r.split(/(\s+|[.,!?;:()[\]{}'"-])/),s="";for(let u of p)F(u)||u===""?s+=u:s+=K(u,n,o);let c={backspace:a.length,insert:s};return a=s,c},backspace(){return t.isEmpty()?{backspace:0,insert:""}:(t.pop(),i())},commit(){return t.isEmpty()?{backspace:0,insert:""}:(t.clear(),a="",{backspace:0,insert:""})},reset(){t.clear(),a=""}}}function de(e){let n=e.value.length,o=e.selectionStart??n,t=e.selectionEnd??n;return{start:Math.max(0,Math.min(o,n)),end:Math.max(0,Math.min(t,n))}}function ge(e){try{let n=new InputEvent("input",{bubbles:!0,cancelable:!1,inputType:"insertText",data:null});e.dispatchEvent(n)}catch{let n=new Event("input",{bubbles:!0,cancelable:!1});e.dispatchEvent(n)}}function m(e,n,o){let{start:t,end:a}=de(e),i=Math.max(0,t-Math.max(0,n));if(typeof e.setRangeText=="function")e.setRangeText(o,i,a,"end");else{let p=`${e.value.slice(0,i)}${o}${e.value.slice(a)}`;e.value=p;let s=i+o.length;e.setSelectionRange(s,s)}ge(e);let r=i+o.length;return{start:r,end:r}}var E=class{element;constructor(n){this.element=n}deleteAndInsert(n,o,t){if(typeof n=="number"){if(!this.element||typeof o!="string")throw new Error("DOMIntegrator requires a bound element for deleteAndInsert(backspace, insert).");return m(this.element,n,o)}if(typeof o!="number"||typeof t!="string")throw new Error("deleteAndInsert(el, backspace, insert) requires all arguments.");return m(n,o,t)}};function me(e){if(e.childNodes.length===0){let t=e.ownerDocument.createTextNode("");return e.appendChild(t),t}if(e.childNodes.length===1&&e.firstChild?.nodeType===Node.TEXT_NODE)return e.firstChild;let n=e.textContent??"";e.textContent="";let o=e.ownerDocument.createTextNode(n);return e.appendChild(o),o}function w(e,n,o){let t=e.ownerDocument.getSelection();if(!t||t.rangeCount===0)return{collapsed:!1,applied:!1};let a=t.getRangeAt(0);if(!a.collapsed||!e.contains(a.startContainer))return{collapsed:!1,applied:!1};let i=me(e),r=i.data,p=r.length;a.startContainer===i&&(p=Math.max(0,Math.min(a.startOffset,r.length)));let s=Math.max(0,p-Math.max(0,n)),c=`${r.slice(0,s)}${o}${r.slice(p)}`;i.data=c;let u=s+o.length,g=e.ownerDocument.createRange();return g.setStart(i,u),g.collapse(!0),t.removeAllRanges(),t.addRange(g),{collapsed:!0,applied:!0}}function fe(e){return e instanceof HTMLTextAreaElement?!0:e instanceof HTMLInputElement?e.type==="text":!1}function ke(e){return e instanceof HTMLElement&&e.isContentEditable}function Te(e){return e.ctrlKey||e.altKey||e.metaKey}function xe(e){return e===" "||e==="Enter"||e==="Tab"}function G(e){let n=e.element,o=e.engine,t=e.onEditApplied,a=e.onBypass,i=e.enabled??!0,r=!1,p=!1,s=l=>{if(fe(n))return m(n,l.backspace,l.insert),t?.(l),!0;if(ke(n)){let y=w(n,l.backspace,l.insert);return y.collapsed?y.applied?(t?.(l),!0):!1:(a?.("selection"),!1)}return a?.("unsupported-target"),!1},c=()=>{p=!0},u=()=>{p=!1},g=l=>{if(!i){a?.("disabled");return}if(Te(l)){a?.("modifier");return}if(p){a?.("composition");return}if(xe(l.key)){o.commit();return}if(l.key!=="Backspace")return;let y=o.backspace();y.backspace===0&&y.insert===""||s(y)&&l.preventDefault()},S=l=>{if(!i){a?.("disabled");return}if(p){a?.("composition");return}if(l.inputType!=="insertText")return;let y=l.data;if(!y)return;let U=y.length>1?o.processText(y):o.processChar(y);s(U)&&l.preventDefault()};return{attach(){r||(n.addEventListener("compositionstart",c),n.addEventListener("compositionend",u),n.addEventListener("keydown",g),n.addEventListener("beforeinput",S),r=!0)},detach(){r&&(n.removeEventListener("compositionstart",c),n.removeEventListener("compositionend",u),n.removeEventListener("keydown",g),n.removeEventListener("beforeinput",S),r=!1)},isAttached(){return r}}}var be={devanagari:{base:I},marathi:{phonetic:{base:A,expanded:C}}};return J(ve);})();
//# sourceMappingURL=indic-ime.iife.js.map